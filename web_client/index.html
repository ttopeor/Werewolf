<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Werewolf Tester</title>
</head>
<script src="/socket.io/socket.io.js"></script>
<script
        src="https://code.jquery.com/jquery-2.2.4.min.js"
        integrity="sha256-BbhdlvQf/xTY9gja0Dq3HiwQF8LaCRTXxZKRutelT44="
        crossorigin="anonymous"></script>
<link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet"
      integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"
        integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa"
        crossorigin="anonymous"></script>
<script src='https://code.responsivevoice.org/responsivevoice.js'></script>
<style type="text/css">
    #message {
        margin-top:100px;
        height: 100px;
        overflow: auto;
        overflow-scrolling: auto;
        color: darkred;
    }
    body{
        background-color: #fff;
    }
    .screen{
        font-size: 30px;
    }
    #log {
        text-align: center;
    }
    #music{
        display:None;
    }
    #reply {
        text-align: center;
    }
    .light{
        font-size: 40px;
        text-align: center;
    }
    #c-light{
         font-size: 50px;
        text-align: center;
    }
    #backlog{
        margin-top:100px;
        float: left;
        width: 20%;
        height: 600px;
        overflow: auto;
        position: absolute;
        top:0px;
        left: 0px;
    }
</style>

<body>

<h1 style="text-align: center;color:#fff;background-color: burlywood">Werewolf Web client</h1>
<h3 style="width: 20%;background-color: burlywood">Log</h3>
<div id="backlog">
</div>
<div id="player" class="container">
    <div class="row">
        <div class="client col-md-2" data="1">
            <img style="width: 100%" src="res/werewolf.png">
            <div class="light">
                <span class="green label label-success">   </span>
                <span class="red label label-danger">   </span>
            </div>
            <div class="btn-group" role="group">
                <button class="btn btn-info pbtn" data="1"><span class="glyphicon glyphicon-menu-left"
                                                                 aria-hidden="true"></span></button>
                <button class="btn btn-info pbtn" data="2"><span class="glyphicon glyphicon-menu-right"
                                                                 aria-hidden="true"></span></button>
                <button class="btn btn-info pbtn" data="3"><span class="glyphicon glyphicon-ok"
                                                                 aria-hidden="true"></span></button>
                <button class="btn btn-info pbtn" data="4"><span class="glyphicon glyphicon-remove"
                                                                 aria-hidden="true"></span></button>
            </div>
        </div>
        <div class="client col-md-2" data="2">
            <img style="width: 100%" src="res/werewolf.png">
            <div class="light">
                <span class="green label label-success">   </span>
                <span class="red label label-danger">   </span>
            </div>
            <div class="btn-group" role="group">
                <button class="btn btn-info pbtn" data="1"><span class="glyphicon glyphicon-menu-left"
                                                                 aria-hidden="true"></span></button>
                <button class="btn btn-info pbtn" data="2"><span class="glyphicon glyphicon-menu-right"
                                                                 aria-hidden="true"></span></button>
                <button class="btn btn-info pbtn" data="3"><span class="glyphicon glyphicon-ok"
                                                                 aria-hidden="true"></span></button>
                <button class="btn btn-info pbtn" data="4"><span class="glyphicon glyphicon-remove"
                                                                 aria-hidden="true"></span></button>
            </div>
        </div>
        <div class="client col-md-2" data="3">
            <img style="width: 100%" src="res/werewolf.png">
            <div class="light">
                <span class="green label label-success">   </span>
                <span class="red label label-danger">   </span>
            </div>
            <div class="btn-group" role="group">
                <button class="btn btn-info pbtn" data="1"><span class="glyphicon glyphicon-menu-left"
                                                                 aria-hidden="true"></span></button>
                <button class="btn btn-info pbtn" data="2"><span class="glyphicon glyphicon-menu-right"
                                                                 aria-hidden="true"></span></button>
                <button class="btn btn-info pbtn" data="3"><span class="glyphicon glyphicon-ok"
                                                                 aria-hidden="true"></span></button>
                <button class="btn btn-info pbtn" data="4"><span class="glyphicon glyphicon-remove"
                                                                 aria-hidden="true"></span></button>
            </div>
        </div>
        <div class="client col-md-2" data="4">
            <img style="width: 100%" src="res/werewolf.png">
            <div class="light">
                <span class="green label label-success">   </span>
                <span class="red label label-danger">   </span>
            </div>
            <div class="btn-group" role="group">
                <button class="btn btn-info pbtn" data="1"><span class="glyphicon glyphicon-menu-left"
                                                                 aria-hidden="true"></span></button>
                <button class="btn btn-info pbtn" data="2"><span class="glyphicon glyphicon-menu-right"
                                                                 aria-hidden="true"></span></button>
                <button class="btn btn-info pbtn" data="3"><span class="glyphicon glyphicon-ok"
                                                                 aria-hidden="true"></span></button>
                <button class="btn btn-info pbtn" data="4"><span class="glyphicon glyphicon-remove"
                                                                 aria-hidden="true"></span></button>
            </div>
        </div>
        <div class="client col-md-2" data="5">
            <img style="width: 100%" src="res/witch.png">
            <div class="light">
                <span class="green label label-success">   </span>
                <span class="red label label-danger">   </span>
            </div>
            <div class="btn-group" role="group">
                <button class="btn btn-info pbtn" data="1"><span class="glyphicon glyphicon-menu-left"
                                                                 aria-hidden="true"></span></button>
                <button class="btn btn-info pbtn" data="2"><span class="glyphicon glyphicon-menu-right"
                                                                 aria-hidden="true"></span></button>
                <button class="btn btn-info pbtn" data="3"><span class="glyphicon glyphicon-ok"
                                                                 aria-hidden="true"></span></button>
                <button class="btn btn-info pbtn" data="4"><span class="glyphicon glyphicon-remove"
                                                                 aria-hidden="true"></span></button>
            </div>
        </div>
        <div class="client col-md-2" data="6">
            <img style="width: 100%" src="res/seer.png">
            <div class="light">
                <span class="green label label-success">   </span>
                <span class="red label label-danger">   </span>
            </div>
            <div class="btn-group" role="group">
                <button class="btn btn-info pbtn" data="1"><span class="glyphicon glyphicon-menu-left"
                                                                 aria-hidden="true"></span></button>
                <button class="btn btn-info pbtn" data="2"><span class="glyphicon glyphicon-menu-right"
                                                                 aria-hidden="true"></span></button>
                <button class="btn btn-info pbtn" data="3"><span class="glyphicon glyphicon-ok"
                                                                 aria-hidden="true"></span></button>
                <button class="btn btn-info pbtn" data="4"><span class="glyphicon glyphicon-remove"
                                                                 aria-hidden="true"></span></button>
            </div>
        </div>
        <div id="log" class="col-md-12">
            <div id="message">

            </div>
            <div>
                <span class="label label-warning screen"  id="screen1">1</span><span class="label label-warning screen" id="screen2">1</span>
            </div>
            <div id="c-light">
                <span class="green label label-success">   </span>
                <span class="red label label-danger">   </span>
            </div>

        </div>
        <div class="client col-md-2" data="7">
            <img style="width: 100%" src="res/hunter.png">
            <div class="light">
                <span class="green label label-success">   </span>
                <span class="red label label-danger">   </span>
            </div>
            <div class="btn-group" role="group">
                <button class="btn btn-info pbtn" data="1"><span class="glyphicon glyphicon-menu-left"
                                                                 aria-hidden="true"></span></button>
                <button class="btn btn-info pbtn" data="2"><span class="glyphicon glyphicon-menu-right"
                                                                 aria-hidden="true"></span></button>
                <button class="btn btn-info pbtn" data="3"><span class="glyphicon glyphicon-ok"
                                                                 aria-hidden="true"></span></button>
                <button class="btn btn-info pbtn" data="4"><span class="glyphicon glyphicon-remove"
                                                                 aria-hidden="true"></span></button>
            </div>
        </div>
        <div class="client col-md-2" data="8">
            <img style="width: 100%" src="res/moron.png">
            <div class="light">
                <span class="green label label-success">   </span>
                <span class="red label label-danger">   </span>
            </div>
            <div class="btn-group" role="group">
                <button class="btn btn-info pbtn" data="1"><span class="glyphicon glyphicon-menu-left"
                                                                 aria-hidden="true"></span></button>
                <button class="btn btn-info pbtn" data="2"><span class="glyphicon glyphicon-menu-right"
                                                                 aria-hidden="true"></span></button>
                <button class="btn btn-info pbtn" data="3"><span class="glyphicon glyphicon-ok"
                                                                 aria-hidden="true"></span></button>
                <button class="btn btn-info pbtn" data="4"><span class="glyphicon glyphicon-remove"
                                                                 aria-hidden="true"></span></button>
            </div>
        </div>
        <div class="client col-md-2" data="9">
            <img style="width: 100%" src="res/villager.png">
            <div class="light">
                <span class="green label label-success">   </span>
                <span class="red label label-danger">   </span>
            </div>
            <div class="btn-group" role="group">
                <button class="btn btn-info pbtn" data="1"><span class="glyphicon glyphicon-menu-left"
                                                                 aria-hidden="true"></span></button>
                <button class="btn btn-info pbtn" data="2"><span class="glyphicon glyphicon-menu-right"
                                                                 aria-hidden="true"></span></button>
                <button class="btn btn-info pbtn" data="3"><span class="glyphicon glyphicon-ok"
                                                                 aria-hidden="true"></span></button>
                <button class="btn btn-info pbtn" data="4"><span class="glyphicon glyphicon-remove"
                                                                 aria-hidden="true"></span></button>
            </div>
        </div>
        <div class="client col-md-2" data="10">
            <img style="width: 100%" src="res/villager.png">
            <div class="light">
                <span class="green label label-success">   </span>
                <span class="red label label-danger">   </span>
            </div>
            <div class="btn-group" role="group">
                <button class="btn btn-info pbtn" data="1"><span class="glyphicon glyphicon-menu-left"
                                                                 aria-hidden="true"></span></button>
                <button class="btn btn-info pbtn" data="2"><span class="glyphicon glyphicon-menu-right"
                                                                 aria-hidden="true"></span></button>
                <button class="btn btn-info pbtn" data="3"><span class="glyphicon glyphicon-ok"
                                                                 aria-hidden="true"></span></button>
                <button class="btn btn-info pbtn" data="4"><span class="glyphicon glyphicon-remove"
                                                                 aria-hidden="true"></span></button>
            </div>
        </div>
        <div class="client col-md-2" data="11">
            <img style="width: 100%" src="res/villager.png">
            <div class="light">
                <span class="green label label-success">   </span>
                <span class="red label label-danger">   </span>
            </div>
            <div class="btn-group" role="group">
                <button class="btn btn-info pbtn" data="1"><span class="glyphicon glyphicon-menu-left"
                                                                 aria-hidden="true"></span></button>
                <button class="btn btn-info pbtn" data="2"><span class="glyphicon glyphicon-menu-right"
                                                                 aria-hidden="true"></span></button>
                <button class="btn btn-info pbtn" data="3"><span class="glyphicon glyphicon-ok"
                                                                 aria-hidden="true"></span></button>
                <button class="btn btn-info pbtn" data="4"><span class="glyphicon glyphicon-remove"
                                                                 aria-hidden="true"></span></button>
            </div>
        </div>
        <div class="client col-md-2" data="12">
            <img style="width: 100%" src="res/villager.png">
            <div class="light">
                <span class="green label label-success">   </span>
                <span class="red label label-danger">   </span>
            </div>
            <div class="btn-group" role="group">
                <button class="btn btn-info pbtn" data="1"><span class="glyphicon glyphicon-menu-left"
                                                                 aria-hidden="true"></span></button>
                <button class="btn btn-info pbtn" data="2"><span class="glyphicon glyphicon-menu-right"
                                                                 aria-hidden="true"></span></button>
                <button class="btn btn-info pbtn" data="3"><span class="glyphicon glyphicon-ok"
                                                                 aria-hidden="true"></span></button>
                <button class="btn btn-info pbtn" data="4"><span class="glyphicon glyphicon-remove"
                                                                 aria-hidden="true"></span></button>
            </div>
        </div>
    </div>

</div>

</body>
<script>
    var socket = io();
    socket.on("message", function (e) {
        e = String(e);
        console.log(e);
        if (e.startsWith("GLIGHT")) {
            update_lights("green", e.toString().split(":")[1]);
        } else if (e.startsWith("RLIGHT")) {
            update_lights("red", e.toString().split(":")[1]);

        } else if (e.startsWith("CLIGHT")){
            var status = e.toString().split(":")[1].split(",");
            console.log(status);
            if(status[0] == 1){
                $("#c-light .green").addClass("label-success");
            }else{
                $("#c-light .green").removeClass("label-success");
            }

            if(status[1] == 1){
                $("#c-light .red").addClass("label-danger");
                console.log("open red light");
            }else{
                console.log("close red light");
                $("#c-light .red").removeClass("label-danger");
            }

        } else if(e.startsWith("SCREEN")){
            var text = e.toString().split(":")[1];
            console.log("VALUE=" + text);
            $("#screen1").text(text[0]);
            $("#screen2").text(text[1]);

        } else {
            $("#backlog").append("<h3>" + e +"</h3>");
            if(!e.startsWith("Debug:")){
                $("#message").html("<h1>" + e + "</h1>");
                //responsiveVoice.speak(e, "Chinese Female");
            }
            


        }

    });

    function playerMusic(name){
        console.log("play music!");

        $("#music").get(0).play();
    }

    function update_lights(color, data) {
        console.log("updating light");
        var d = parseInt(data);
        var class_name = color == "green" ? "label-success" : "label-danger";
        for (var i = 0; i < 12; i++) {
            if ((d & 1 << (i)) > 0) {
                $(".client[data=" + (i+1) + "] ." + color + "").addClass(class_name);
            } else {
                $(".client[data=" + (i+1) + "] ." + color + "").removeClass(class_name);
            }
        }
    }
    $(function () {

        $("#send").click(function () {
            socket.emit("reply", $("#mas").val());
            $("#mas").val("");
        });
        $(".pbtn").each(function (i, v) {
            $(v).click(function () {
                var id = $(this).parent().parent().attr("data");
                var btn = $(this).attr("data");
                socket.emit("reply", [id, btn]);
            })
        });
    });
</script>
</html>